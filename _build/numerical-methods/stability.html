---
interact_link: content/numerical-methods/stability.ipynb
kernel_name: matlab
kernel_path: content/numerical-methods
has_widgets: false
title: |-
  Stability and Stiffness
pagenum: 6
prev_page:
  url: /numerical-methods/initial-value-methods.html
next_page:
  url: /second-order/second-order.html
suffix: .ipynb
search: delta y t x method yi euler stability frac leq stable begin end equation backward align solution step dy forward f e sigma ode problem recursion formula quad lets order methods left right analysis well behaved not want unstable also numerical scheme example dt stiff size unconditionally dx where system systems blows explicit schemes sizes error general choice conditionally text solve need therefore those exact such behavior consider initial condition obtain smaller increase instability away larger should expect based value case remains matches any parameters always because implicit actually useable saw does perform remain gather rightarrow safety stiffness past youve

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Stability and Stiffness</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the past when you've talked about <strong>stability</strong>, it has likely been regarding the stability of a <em>system</em>. Stable systems are those will well-behaved exact solutions, meaning they do not grow unbounded.
In engineering we mostly focus (or want!) stable systems, although there are some interesting unstable systems such as those involving resonance, nonlinear dynamics, or chaos—generally we want to know when that happens so we can prevent it.</p>
<p>We can also define the stability of a <em>numerical scheme</em>, which is when the numerical solution exhibits unphysical behavior. In other words, it blows up.</p>
<p>For example, let's consider the relatively simple 1st-order ODE
\begin{equation}
\frac{dy}{dt} = -3 y
\end{equation}
with the initial condition $y(0) = 1$. As we will see, this ODE can cause explicit numerical schemes to become unstable, and thus it is a <strong>stiff</strong> ODE. (Note that we can easily obtain the exact solution for this problem, which is $y(t) = e^{-3 t}$.)</p>
<p>Let's try solving this with the Forward Euler method, integrating over $0 \leq t \leq 10$, for a range of time-step size values: $\Delta t = 0.1, 0.25, 0.5, 0.75$:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">clear</span>
<span class="s">f = @(t,y) -3*y</span><span class="p">;</span>

<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dt</span> <span class="p">:</span> <span class="mi">20</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span><span class="n"></span>
<span class="n">for </span><span class="s">i = 1 : length(t) - 1</span><span class="p"></span>
    <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="n"></span>
<span class="n">end</span>
<span class="s">subplot(4,1,1)</span><span class="p">;</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;dt = %4.2f&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">));</span>

<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.25</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dt</span> <span class="p">:</span> <span class="mi">20</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span><span class="n"></span>
<span class="n">for </span><span class="s">i = 1 : length(t) - 1</span><span class="p"></span>
    <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="n"></span>
<span class="n">end</span>
<span class="s">subplot(4,1,2)</span><span class="p">;</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;dt = %4.2f&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">));</span>

<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dt</span> <span class="p">:</span> <span class="mi">20</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span><span class="n"></span>
<span class="n">for </span><span class="s">i = 1 : length(t) - 1</span><span class="p"></span>
    <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="n"></span>
<span class="n">end</span>
<span class="s">subplot(4,1,3)</span><span class="p">;</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;dt = %4.2f&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">));</span>

<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.75</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dt</span> <span class="p">:</span> <span class="mi">20</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span><span class="n"></span>
<span class="n">for </span><span class="s">i = 1 : length(t) - 1</span><span class="p"></span>
    <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="n"></span>
<span class="n">end</span>
<span class="s">subplot(4,1,4)</span><span class="p">;</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;dt = %4.2f&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/numerical-methods/stability_1_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At the smaller step sizes, $\Delta t = 0.1$ and $\Delta t = 0.25$, we see that the solution is well-behaved. But, when we increase $\Delta t$ to 0.5, we see some instability that goes away with time. Then, when we increase $\Delta t$ to 0.75, the solution eventually blows up, leading to error <strong>much</strong> larger than what we should expect based on the method's order of accuracy (first) and the step size value.</p>
<p>Compare this behavior to that for the ODE
\begin{equation}
\frac{dy}{dt} = e^{-t}
\end{equation}
which is <strong>non-stiff</strong>:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">clear</span>
<span class="s">f = @(t,y) exp(-t)</span><span class="p">;</span>

<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dt</span> <span class="p">:</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span><span class="n"></span>
<span class="n">for </span><span class="s">i = 1 : length(t) - 1</span><span class="p"></span>
    <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="n"></span>
<span class="n">end</span>
<span class="s">subplot(4,1,1)</span><span class="p">;</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;dt = %4.2f&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">));</span>

<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.25</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dt</span> <span class="p">:</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span><span class="n"></span>
<span class="n">for </span><span class="s">i = 1 : length(t) - 1</span><span class="p"></span>
    <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="n"></span>
<span class="n">end</span>
<span class="s">subplot(4,1,2)</span><span class="p">;</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;dt = %4.2f&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">));</span>

<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dt</span> <span class="p">:</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span><span class="n"></span>
<span class="n">for </span><span class="s">i = 1 : length(t) - 1</span><span class="p"></span>
    <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="n"></span>
<span class="n">end</span>
<span class="s">subplot(4,1,3)</span><span class="p">;</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;dt = %4.2f&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">));</span>

<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.75</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dt</span> <span class="p">:</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span><span class="n"></span>
<span class="n">for </span><span class="s">i = 1 : length(t) - 1</span><span class="p"></span>
    <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="n"></span>
<span class="n">end</span>
<span class="s">subplot(4,1,4)</span><span class="p">;</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;dt = %4.2f&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/numerical-methods/stability_3_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this case, we see that the solution remains well-behaved even for larger time-step sizes, and the error matches the expected order based on the method and step-size value.</p>
<p>In general numerical schemes can be:</p>
<ul>
<li><strong>unstable</strong>: the scheme blows up for any choice of parameters</li>
<li><strong>conditionally stable</strong>: the scheme is stable for a particular choice of parameters (for example, $\Delta t$ is less than some threshold</li>
<li><strong>unconditionally stable</strong>: the scheme is always stable</li>
</ul>
<p>Schemes may be stable for some problem/system and not for another, and vice versa.</p>
<p>Stability is related to robustness of a method, which is generally a tradeoff between complexity and computational cost. The choice of method and solution strategy depends on what you want, and how long you can wait for it. In general, we almost always want to use the largest $\Delta t$ allowable.</p>
<p>Rather than reducing $\Delta t$ to avoid stability problems, we can also use a method that is unconditionally stable, such as the <strong>Backward Euler</strong> method.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Backward-Euler-method">Backward Euler method<a class="anchor-link" href="#Backward-Euler-method"> </a></h2><p>The Backward Euler method is very similar to the Forward Euler method, except in one way: it uses the slope at the <em>next</em> time step: 
\begin{equation}
    \left(\frac{dy}{dx}\right)_{i+1} \approx \frac{y_{i+1} - y_i}{\Delta x}
\end{equation}
Then, the resulting recursion formula is
\begin{equation}
y_{i+1} = y_i + \Delta x \left(\frac{dy}{dx}\right)_{i+1}, \text{ or} \\
y_{i+1} = y_i + \Delta x \, f(x_{i+1}, y_{i+1})
\end{equation}
where $f(x,y) = dy/dx$.</p>
<p>Notice that this recursion formula cannot be directly solved, because $y_{i+1}$ shows up on both sides. This is an <strong>implicit</strong> method, where all the other methods we have covered (Forward Euler, Heun's, Midpoint, and 4th-order Runge-Kutta) are <strong>explicit</strong>. Implicit methods require more work to actually implement.</p>
<h3 id="Backward-Euler-example">Backward Euler example<a class="anchor-link" href="#Backward-Euler-example"> </a></h3><p>For example, consider the problem 
\begin{equation} 
\frac{dy}{dx} = f(x,y) = 8 e^{-x} (1+x) - 2y
\end{equation}
To actually solve this problem with the Backward Euler method, we need to incorporate the derivative function $f(x,y)$ into the recursion formula and solve for $y_{i+1}$:
\begin{align}
y_{i+1} &amp;= y_i + \Delta x \, f(x_{i+1}, y_{i+1}) \\
y_{i+1} &amp;= y_i + \Delta x \left[ 8 e^{-x_{i+1}} (1 + x_{i+1}) - 2 y_{i+1} \right] \\
y_{i+1} &amp;= y_i + 8 e^{-x_{i+1}} (1 + x_{i+1}) \Delta x - 2 \Delta x \, y_{i+1} \\
y_{i+1} + 2 \Delta x \, y_{i+1} &amp;= y_i + 8 e^{-x_{i+1}} (1 + x_{i+1}) \Delta x \\
y_{i+1} &amp;= \frac{ y_i + 8 e^{-x_{i+1}} (1 + x_{i+1}) \Delta x }{ 1 + 2 \Delta x }
\end{align}
Now we have a useable recursion formula that we can use to solve this problem. Let's use the initial condition $y(0) = 1$, the domain $0 \leq x \leq 7$, and $\Delta x = 0.2$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">clear</span>

<span class="s">dx = 0.2</span><span class="p">;</span>
<span class="n">x</span> <span class="p">=</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dx</span> <span class="p">:</span> <span class="mi">7</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c">% Backward Euler loop</span>
<span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">1</span> <span class="p">:</span> <span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">dx</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">dx</span><span class="p">);</span><span class="n"></span>
<span class="n">end</span>

<span class="s">x_exact = linspace(0, 7)</span><span class="p">;</span>
<span class="n">y_exact</span> <span class="p">=</span> <span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">x_exact</span><span class="p">)</span><span class="o">.*</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">x_exact</span><span class="o">.*</span><span class="nb">exp</span><span class="p">(</span><span class="n">x_exact</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x_exact</span><span class="p">,</span> <span class="n">y_exact</span><span class="p">);</span><span class="n"> hold </span><span class="s">on</span><span class="p"></span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;o--&#39;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">(</span><span class="s">&#39;Exact solution&#39;</span><span class="p">,</span> <span class="s">&#39;Backward Euler solution&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/numerical-methods/stability_6_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This matches nearly what we saw with the Forward Euler method before—Backward Euler is also a <strong>first-order</strong> method, so the global error should be proportional to $\Delta x$.</p>
<p>Let's now return to the stiff ODE $y^{\prime} = -3 y$, and see how the Backward Euler method does. First, we need to obtain our useable recursion formula:
\begin{align}
y_{i+1} &amp;= y_i + \Delta t \, f(t_{i+1}, y_{i+1}) \\
y_{i+1} &amp;= y_i + \Delta t \, \left( -3 y_{i+1} \right) \\
y_{i+1} + 3 y_{i+1} \Delta t &amp;= y_i \\
y_{i+1} &amp;= \frac{y_i}{1 + 3 \Delta t}
\end{align}</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">clear</span>

<span class="s">dt = 0.1</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dt</span> <span class="p">:</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span><span class="n"></span>
<span class="n">for </span><span class="s">i = 1 : length(t) - 1</span><span class="p"></span>
    <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">dt</span><span class="p">);</span><span class="n"></span>
<span class="n">end</span>
<span class="s">subplot(4,1,1)</span><span class="p">;</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;dt = %4.2f&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">));</span>

<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.25</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dt</span> <span class="p">:</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span><span class="n"></span>
<span class="n">for </span><span class="s">i = 1 : length(t) - 1</span><span class="p"></span>
    <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">dt</span><span class="p">);</span><span class="n"></span>
<span class="n">end</span>
<span class="s">subplot(4,1,2)</span><span class="p">;</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;dt = %4.2f&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">));</span>

<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dt</span> <span class="p">:</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span><span class="n"></span>
<span class="n">for </span><span class="s">i = 1 : length(t) - 1</span><span class="p"></span>
    <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">dt</span><span class="p">);</span><span class="n"></span>
<span class="n">end</span>
<span class="s">subplot(4,1,3)</span><span class="p">;</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;dt = %4.2f&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">));</span>

<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.75</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dt</span> <span class="p">:</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span><span class="n"></span>
<span class="n">for </span><span class="s">i = 1 : length(t) - 1</span><span class="p"></span>
    <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">y</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">dt</span><span class="p">);</span><span class="n"></span>
<span class="n">end</span>
<span class="s">subplot(4,1,4)</span><span class="p">;</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="n">sprintf</span><span class="p">(</span><span class="s">&#39;dt = %4.2f&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/numerical-methods/stability_8_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this case, we see that the solution remains well-behaved for all the step sizes, not showing any of the instability we saw with the Forward Euler method. This is because the Backward Euler method is <strong>unconditionally stable</strong>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Stability-analysis">Stability analysis<a class="anchor-link" href="#Stability-analysis"> </a></h2><h3 id="Stability-analysis-of-Forward-Euler">Stability analysis of Forward Euler<a class="anchor-link" href="#Stability-analysis-of-Forward-Euler"> </a></h3><p>We can perform a stability analysis of the stiff problem to identify when the Forward Euler method becomes unstable. Let's apply the method to the ODE at hand:
\begin{align}
\frac{dy}{dt} &amp;= -3 y \\
y_{i+1} &amp;= y_i + \Delta t f(t_i, y_i) \\
y_{i+1} &amp;= y_i + \Delta t (-3 y_i) \\
 &amp;= y_i (1 - 3 \Delta t) \\
\frac{y_{i+1}}{y_i} &amp;= \sigma = 1 - 3 \Delta t 
\end{align}
where $\sigma$ is the <strong>amplification factor</strong>. This defines whether the solution grows or decays each step—for a stable physical system, we expect the solution to get smaller or remain contant with each step.</p>
<p>Therefore, for the method to remain stable, we must have $\sigma | \leq 1$. We can use this stability criterion to find conditions on $\Delta t$ for stability:
\begin{gather}
| \sigma | = | 1 - 3 \Delta t | \leq 1 \\
-1 \leq 1 - 3 \Delta t \leq 1 \\
-1 \leq 1 - 3 \Delta t \quad \text{or} \quad 1 - 3 \Delta t \leq 1 \\
\frac{-2}{3} \leq -\Delta t \quad \quad -\Delta t \leq 0 \\
\rightarrow \Delta t \leq \frac{2}{3} \quad \text{and} \quad \Delta t \geq 0 \\
\therefore 0 \leq \Delta t \leq \frac{2}{3}
\end{gather}
for stability. (For safety, we might use $\Delta t &lt; 1/2$ for safety, to stay away from the absolute stability limit.)</p>
<p>The Forward Euler method is then <em>conditionally stable</em>.</p>
<p>As a general rule of thumb, all <strong>explicit</strong> methods are conditionally stable; these are methods where the recursion formula for $y_{i+1}$ can be written and calculated explicitly in terms of known quantities.</p>
<h3 id="Stability-analysis-of-Backward-Euler">Stability analysis of Backward Euler<a class="anchor-link" href="#Stability-analysis-of-Backward-Euler"> </a></h3><p>We can also perform a stability analysis on the Backward Euler method to show that its stability does not depend on the step size:
\begin{align}
\frac{dy}{dt} &amp;= -3 y \\
y_{i+1} &amp;= y_i + \Delta t f(t_{i+1}, y_{i+1}) \\
y_{i+1} &amp;= y_i + \Delta t (-3 y_{i+1}) \\
y_{i+1} (1 + 3 \Delta t) &amp;= y_i \\
\sigma &amp;= \frac{y_{i+1}}{y_i} = \frac{1}{1 + 3 \Delta t}
\end{align}
For stability, we need $| \sigma | \leq 1$:
\begin{align}
| \sigma | &amp;= \left| \frac{1}{1 + 3 \Delta t} \right| \leq 1 \\
\rightarrow \Delta t &amp;&gt; 0
\end{align}
Therefore the Backward Euler method is <em>unconditionally stable</em>.</p>

</div>
</div>
</div>
</div>

 


    </main>
    