---
interact_link: content/bvps/eigenvalue.ipynb
kernel_name: matlab
kernel_path: content/bvps
has_widgets: false
title: |-
  Eigenvalue problems
pagenum: 16
prev_page:
  url: /bvps/finite-difference.html
next_page:
  url: /quizzes/quiz2-IVPs.html
suffix: .ipynb
search: y x align begin end lambda k frac l equation n omega m pi eigenvalues left right bmatrix system p b delta beam sin quad lets conditions boundary equations rightarrow different modes det t solution values ei cos case our mathbf get prime example ldots infty mode above into eigenvalue problems where buckling consider deflection mz also need associated represent gather load using yi mass motion masses amplitude odes initial obtain us supported e d ode general neq because instead corresponding connected cr same based finite matrix calculate given spring amplitudes means characteristic value not analytical certain simply governing considering

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Eigenvalue problems</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>"Eigenvalue" means characteristic value. These types of problems show up in many areas involving boundary-value problems, where we may not be able to obtain an analytical solution, but we can identify certain characteristic values that tell us important information about the system: the eigenvalues.</p>
<h2 id="Example:-beam-buckling">Example: beam buckling<a class="anchor-link" href="#Example:-beam-buckling"> </a></h2><p>Let's consider deflection in a simply supported (static) vertical beam: $y(x)$, with boundary conditions $y(0) = 0$ and $y(L) = 0$. To get the governing equation, start with considering the sum of moments around the upper pin:
\begin{align}
\sum M &amp;= M_z + P y = 0 \\
M_z &amp;= -P y
\end{align}</p>
<p>We also know that $M_z = E I y''$, so we can obtain
\begin{align}
M_z = E I \frac{d^2 y}{dx^2} &amp;= -P y \\
y'' + \frac{P}{EI} y &amp;= 0
\end{align}
This equation governs the stability of a beam, considering small deflections.
To simplify things, let's define $\lambda^2 = \frac{P}{EI}$, which gives us the ODE
\begin{equation}
y'' + \lambda^2 y = 0
\end{equation}
We can get the general solution to this:
\begin{equation}
y(x) = A \cos (\lambda x) + B \sin (\lambda x)
\end{equation}</p>
<p>To find the coefficients, let's apply the boundary conditions, starting with $x=0$:
\begin{align}
y(x=0) &amp;= 0 = A \cos 0 + B \sin 0 \\
\rightarrow A &amp;= 0 \\
y(x=L) &amp;= 0 = B \sin (\lambda L)
\end{align}
Now what? $B \neq 0$, because otherwise we would have the trivial solution $y(x) = 0$. Instead, to satisfy the boundary condition, we need
\begin{align}
B \neq 0 \rightarrow \sin (\lambda L) &amp;= 0 \\
\text{so} \quad \lambda L &amp;= n \pi \quad n = 1, 2, 3, \ldots, \infty \\
\lambda &amp;= \frac{n \pi}{L} \quad n = 1, 2, 3, \ldots, \infty
\end{align}
$\lambda$ give the the <strong>eigenvalues</strong> for this problem; as you can see, there are an infinite number, that correspond to <strong>eigenfunctions</strong>:
\begin{equation}
y_n = B \sin \left( \frac{n \pi x}{L} \right) \quad n = 1, 2, 3, \ldots, \infty
\end{equation}</p>
<p>The eigenvalues and associated eigenfunctions physically represent different modes of deflection.
For example, consider the first three modes (corresponding to $n = 1, 2, 3$):</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">clear </span><span class="s">all</span><span class="p">;</span><span class="n"> clc</span>

<span class="s">L = 1.0</span><span class="p">;</span>
<span class="n">x</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="nb">pi</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">L</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="s">&#39;n = 1&#39;</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">pi</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">L</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="s">&#39;n = 2&#39;</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span> <span class="nb">pi</span> <span class="o">*</span> <span class="n">x</span> <span class="o">/</span> <span class="n">L</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span> <span class="n">title</span><span class="p">(</span><span class="s">&#39;n = 3&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/bvps/eigenvalue_1_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here we see different modes of how the beam will buckle. How do we know when this happens?</p>
<p>Recall that the eigenvalue is connected to the physical properties of the beam:
\begin{gather}
\lambda^2 = \frac{P}{EI} \rightarrow \lambda = \sqrt{\frac{P}{EI} = \frac{n \pi}{L} \\
P = \frac{EI}{L} n^2 \pi^2
\end{gather}
This means that when the combination of load force and beam properties match certain values, the beam will deflect—and buckle—in one of the modes corresponding to the associated eigenfunction.</p>
<p>In particular, the first mode ($n=1$) is interesting, because this is the first one that will be encountered if a load starts at zero and increases. This is the <strong>Euler critical load</strong> of buckling, $P_{cr}$:
\begin{gather}
\lambda_1 = \frac{\pi}{L} \rightarrow \lambda_1^2 = \frac{P}{EI} = \frac{\pi^2}{L^2} \\
P_{cr} = \frac{\pi^2 E I}{L^2}
\end{gather}</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example:-beam-buckling-with-different-boundary-conditions">Example: beam buckling with different boundary conditions<a class="anchor-link" href="#Example:-beam-buckling-with-different-boundary-conditions"> </a></h2><p>Let's consider a slightly different case, where at $x=0$ the beam is supported such that $y'(0) = 0$. How does the beam buckle in this case?</p>
<p>The governing equation and general solution are the same:
\begin{align}
y'' + \lambda^2 y &amp;= 0 \\
y(x) &amp;= A \cos (\lambda x) + B \sin (\lambda x)
\end{align}
but our boundary conditions are now different:
\begin{align}
y'(0) = 0 = -\lambda A \sin(0) + \lambda B\cos(0) \\
\rightarrow B &amp;= 0 \\
y &amp;= A \cos (\lambda x) \\
y(L) &amp;= 0 = A \cos (\lambda L) \\
A \neq 0 \rightarrow \cos(\lambda L) &amp;= 0 \\
\text{so} \quad \lambda L &amp;= \frac{(2n-1) \pi}{2} \quad n = 1,2,3,\ldots, \infty \\
\lambda &amp;= \frac{(2n-1) \pi}{2 L} \quad n = 1,2,3,\ldots, \infty
\end{align}</p>
<p>Then, the critical buckling load, again corresponding to $n=1$, is
\begin{equation}
P_{cr} = \frac{\pi^2 EI}{4 L^2}
\end{equation}</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Getting-eigenvalues-numerically">Getting eigenvalues numerically<a class="anchor-link" href="#Getting-eigenvalues-numerically"> </a></h2><p>We can only get the eigenvalues analytically if we can obtain an analytical solution of the ODE, but we might want to get eigenvalues for more complex problems too. In that case, we can use an approach based on <em>finite differences</em> to find the eigenvalues.</p>
<p>Consider the same problem as above, for deflection of a simply supported beam:
\begin{equation}
y'' + \lambda^2 y = 0 
\end{equation}
with boundary conditions $y(0) = 0$ and $y(L) = 0$. Let's represent this using finite differences, for a case where $L=3$ and $\Delta x = 1$, so we have four points in our solution grid.</p>
<p>The finite difference representation of the ODE is:
\begin{align}
\frac{y_{i-1} - 2y_i + y_{i+1}}{\Delta x^2} + \lambda^2 y_i &amp;= 0 \\
y_{i-1} + \left( \lambda^2 \Delta x^2 - 2 \right) y_i + y_{i+1} &amp;= 0
\end{align}
However, in this case, we are not solving for the values of deflection ($y_i$), but instead the <strong>eigenvalues</strong> $\lambda$.</p>
<p>Then, we can write the system of equations using the above recursion formula and our two boundary conditions:
\begin{align}
y_1 &amp;= 0 \\
y_1 + y_2 \left( \lambda^2 \Delta x^2 - 2 \right) + y_3 &amp;= 0 \\
y_2 + y_3 \left( \lambda^2 \Delta x^2 - 2 \right) + y_4 &amp;= 0 \\
y_4 &amp;= 0
\end{align}
which we can simplify down to two equations by incorporating the boundary conditions into the equations for the two middle points, and also letting $k = \lambda^2 \Delta x^2$:
\begin{align}
y_2 (k-2) + y_3 &amp;= 0 \\
y_2 + y_3 (k-2) &amp;= 0
\end{align}
Let's modify this once more by multiplying both equations by $-1$:
\begin{align}
y_2 (2-k) - y_3 &amp;= 0 \\
-y_2 + y_3 (2-k) &amp;= 0
\end{align}</p>
<p>Now we can represent this system of equations as a matrix equation $A \mathbf{y} = \mathbf{b} = \mathbf{0}$:
\begin{equation}
\begin{bmatrix} 2-k &amp; -1 \\ -1 &amp; 2-k \end{bmatrix}
\begin{bmatrix} y_2 \\ y_3 \end{bmatrix} = \begin{bmatrix} 0 \\ 0 \end{bmatrix}
\end{equation}
$\mathbf{y} = \mathbf{0}$ is a trivial solution to this, so instead $\det(A) = 0$ satisfies this equation.
For our $2\times 2$ matrix, that looks like:
\begin{align}
\det(A) = \begin{vmatrix} 2-k &amp; -1 \\ -1 &amp; 2-k \end{vmatrix} = (2-k)^2 - 1 &amp;= 0 \\
k^2 - 4k + 3 &amp;= 0 \\
(k-3)(k-1) &amp;= 0
\end{align}
so the roots of this equation are $k_1 = 1$ and $k_2 = 3$. Recall that $k$ is directly related to the eigenvalue: $k = \lambda^2 \Delta x^2$, and $\Delta x = 1$ for this case, so we can calculate the two associated eigenvalues:
\begin{align}
k_1 &amp;= \lambda_1^2 \Delta x^2 = 1 \rightarrow \lambda_1 = 1 \\
k_2 &amp;= \lambda_2^2 \Delta x^2 = 3 \rightarrow \lambda_2 = \sqrt{3} = 1.732
\end{align}</p>
<p>Our work has given us approximations for the first two eigenvalues. We can compare these against the exact values, given in general by $\lambda = n \pi / L$ (which we determined above):
\begin{align}
n=1: \quad \lambda_1 &amp;= \frac{\pi}{L} = \frac{\pi}{3} = 1.0472 \\
n=2: \quad \lambda_2 &amp;= \frac{2\pi}{L} = \frac{2\pi}{3} = 2.0944
\end{align}
So, our approximations are close, but with some obvious error. This is because we used a fairly crude step size of $\Delta x = 1$, dividing the domain into just three segments. By using a finer resolution, we can get more-accurate eigenvalues and also more of them (remember, there are actually an infinite number!).</p>
<p>To do that, we will need to use Matlab, which offers the <code>eig()</code> function for calculating eigenvalues---essentially it is finding the roots to the polynomial given by $\det(A) = 0$. We need to modify this slightly, though, to use the function:
\begin{align}
\det(A) &amp;= 0 \\
\det \left( A^* - k I \right) = 0
\end{align}
where the new matrix is
\begin{equation}
A^* = \begin{bmatrix} 2 &amp; -1 \\ -1 &amp; 2 \end{bmatrix}
\end{equation}
Then, <code>eig(A*)</code> will provide the values of $k$, which we can use to find the $\lambda$s:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">clear </span><span class="s">all</span><span class="p">;</span><span class="n"> clc</span>

<span class="s">dx = 1.0</span><span class="p">;</span>
<span class="n">L</span> <span class="p">=</span> <span class="mf">3.0</span><span class="p">;</span>

<span class="n">Astar</span> <span class="p">=</span> <span class="p">[</span><span class="mi">2</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">2</span><span class="p">];</span>
<span class="n">k</span> <span class="p">=</span> <span class="n">eig</span><span class="p">(</span><span class="n">Astar</span><span class="p">);</span>

<span class="n">lambda</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">/</span> <span class="n">dx</span><span class="p">;</span>

<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;lambda_1: %6.3f\n&#39;</span><span class="p">,</span> <span class="n">lambda</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;lambda_2: %6.3f&#39;</span><span class="p">,</span> <span class="n">lambda</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lambda_1:  1.000
lambda_2:  1.732</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As expected, this matches with our manual calculation above. But, we might want to calculate these eigenvalues more accurately, so let's generalize this a bit and then try using $\Delta x= 0.1$:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">clear </span><span class="s">all</span><span class="p">;</span><span class="n"> clc</span>

<span class="s">dx = 0.1</span><span class="p">;</span>
<span class="n">L</span> <span class="p">=</span> <span class="mf">3.0</span><span class="p">;</span>
<span class="n">x</span> <span class="p">=</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dx</span> <span class="p">:</span> <span class="n">L</span><span class="p">;</span>
<span class="n">n</span> <span class="p">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span>

<span class="n">Astar</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">);</span><span class="n"></span>
<span class="n">for </span><span class="s">i = 1 : n</span><span class="p"></span>
<span class="n">    if </span><span class="s">i == 1</span><span class="p"></span>
        <span class="n">Astar</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">2</span><span class="p">;</span>
        <span class="n">Astar</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n"></span>
<span class="n">    elseif </span><span class="s">i == n</span><span class="p"></span>
        <span class="n">Astar</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">Astar</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="p">=</span> <span class="mi">2</span><span class="p">;</span><span class="n"></span>
<span class="n">    else</span>
<span class="n">        </span><span class="s">Astar(i,i-1) = -1</span><span class="p">;</span>
        <span class="n">Astar</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="mi">2</span><span class="p">;</span>
        <span class="n">Astar</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span><span class="n"></span>
<span class="n">    end</span>
<span class="s">end</span><span class="p"></span>
<span class="n">k</span> <span class="p">=</span> <span class="n">eig</span><span class="p">(</span><span class="n">Astar</span><span class="p">);</span>

<span class="n">lambda</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">/</span> <span class="n">dx</span><span class="p">;</span>

<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;lambda_1: %6.3f\n&#39;</span><span class="p">,</span> <span class="n">lambda</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;lambda_2: %6.3f\n\n&#39;</span><span class="p">,</span> <span class="n">lambda</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

<span class="n">err</span> <span class="p">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">lambda</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nb">pi</span><span class="o">/</span><span class="n">L</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="nb">pi</span><span class="o">/</span><span class="n">L</span><span class="p">);</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;Error in lambda_1: %5.2f%%\n&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="n">err</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>lambda_1:  1.047
lambda_2:  2.091

Error in lambda_1:  0.05%
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example:-mass-spring-system">Example: mass-spring system<a class="anchor-link" href="#Example:-mass-spring-system"> </a></h2><p>Let's analyze the motion of masses connected by springs in a system:</p>
<p><figure>
  <center>
  <img src="../images/mass-spring-system.jpg" alt="mass-spring system" style="width: 400px;"/>
  <figcaption>Figure: System with two masses connected by springs</figcaption>
  </center>
</figure>
First, we need to write the equations of motion, based on doing a free-body diagram on each mass:
\begin{align}
m_1 \frac{d^2 x_1}{dt^2} &amp;= -k x_1 + k(x_2 - x_1) \\
m_2 \frac{d^2 x_2}{dt^2} &amp;= -k (x_2 - x_1) - k x_2
\end{align}
We can condense these equations a bit:
\begin{align}
x_1^{\prime\prime} - \frac{k}{m_1} \left( -2 x_1 + x_2 \right) &amp;= 0 \\
x_2^{\prime\prime} - \frac{k}{m_2} \left( x_1 - 2 x_2 \right) &amp;= 0
\end{align}</p>
<p>To proceed, we can assume that the masses will move in a sinusoidal fashion, with a shared frequency but separate amplitude:
\begin{align}
x_i &amp;= A_i \sin (\omega t) \\
x_i^{\prime\prime} &amp;= -A_i \omega^2 \sin (\omega t)
\end{align}
We can plug these into the ODEs:
\begin{align}
\sin (\omega t) \left[ \left( \frac{2k}{m_1} - \omega^2 \right) A_1 - \frac{k}{m_1} A_2 \right] &amp;= 0 \\
\sin (\omega t) \left[ -\frac{k}{m_2} A_1 + \left( \frac{2k}{m_2} - \omega^2 \right) A_2 \right] &amp;= 0
\end{align}
or
\begin{align}
\left( \frac{2k}{m_1} - \omega^2 \right) A_1 - \frac{k}{m_1} A_2 &amp;= 0 \\
-\frac{k}{m_2} A_1 + \left( \frac{2k}{m_2} - \omega^2 \right) A_2 &amp;= 0
\end{align}
Let's put some numbers in, and try to solve for the eigenvalues: $\omega^2$.
Let $m_1 = m_2 = 40 $ kg and $k = 200$ N/m.</p>
<p>Now, the equations become
\begin{align}
\left( 10 - \omega^2 \right) A_1 - 5 A_2 &amp;= 0 \\
-5 A_1 + \left( 10 - \omega^2 \right) A_2 &amp;= 0
\end{align}
or $A \mathbf{y} = \mathbf{0}$, which we can represent as
\begin{equation}
\begin{bmatrix} 10-\omega^2 &amp; -5 \\ -5 &amp; 10-\omega^2 \end{bmatrix}
\begin{bmatrix} A_1 \\ A_2 \end{bmatrix} = 
\begin{bmatrix} 0 \\ 0 \end{bmatrix}
\end{equation}
Here, $\omega^2$ are the eigenvalues, and we can find them with $\det(A) = 0$:
\begin{align}
\det(B) &amp;= 0 \\
\det (B^* - \omega^2 I) &amp;= 0
\end{align}</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">clear </span><span class="s">all</span><span class="p">;</span><span class="n"> clc</span>

<span class="s">Bstar = [10 -5</span><span class="p">;</span> <span class="o">-</span><span class="mi">5</span> <span class="mi">10</span><span class="p">];</span>
<span class="n">omega_squared</span> <span class="p">=</span> <span class="n">eig</span><span class="p">(</span><span class="n">Bstar</span><span class="p">);</span>
<span class="n">omega</span> <span class="p">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="n">omega_squared</span><span class="p">);</span>

<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;omega_1 = %5.2f rad/s\n&#39;</span><span class="p">,</span> <span class="n">omega</span><span class="p">(</span><span class="mi">1</span><span class="p">));</span>
<span class="n">fprintf</span><span class="p">(</span><span class="s">&#39;omega_2 = %5.2f rad/s\n&#39;</span><span class="p">,</span> <span class="n">omega</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>omega_1 =  2.24 rad/s
omega_2 =  3.87 rad/s
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We find there are two modes of oscillation, each associated with a different natural frequency. Unfortunately, we cannot calculate independent and unique values for the amplitudes, but if we insert the values of $\omega$ into the above equations, we can find relations connecting the amplitudes:
\begin{align}
\omega_1: \quad A_1 &amp;= A_2 \\
\omega_2: \quad A_1 &amp;= -A_2
\end{align}</p>
<p>So, for the first mode, we have the two masses moving in sync with the same amplitude. In the second mode, they move with opposite (but equal) amplitude. With the two different frequencies, they also have two different periods:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">t</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="nb">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">);</span><span class="n"> hold </span><span class="s">on</span><span class="p"></span>
<span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;s&#39;</span><span class="p">);</span>
<span class="n">set</span> <span class="p">(</span><span class="n">gca</span><span class="p">,</span> <span class="s">&#39;ydir&#39;</span><span class="p">,</span> <span class="s">&#39;reverse&#39;</span> <span class="p">)</span>
<span class="n">box </span><span class="s">off</span><span class="p">;</span> <span class="n">set</span><span class="p">(</span><span class="n">gca</span><span class="p">,</span><span class="s">&#39;Visible&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">)</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="nb">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">);</span><span class="n"> hold </span><span class="s">on</span><span class="p"></span>
<span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;s&#39;</span><span class="p">);</span>
<span class="n">set</span> <span class="p">(</span><span class="n">gca</span><span class="p">,</span> <span class="s">&#39;ydir&#39;</span><span class="p">,</span> <span class="s">&#39;reverse&#39;</span> <span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="s">&#39;First mode&#39;</span><span class="p">)</span>
<span class="n">box </span><span class="s">off</span><span class="p">;</span> <span class="n">set</span><span class="p">(</span><span class="n">gca</span><span class="p">,</span><span class="s">&#39;Visible&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">)</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="nb">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">);</span><span class="n"> hold </span><span class="s">on</span><span class="p"></span>
<span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;s&#39;</span><span class="p">);</span>
<span class="n">set</span> <span class="p">(</span><span class="n">gca</span><span class="p">,</span> <span class="s">&#39;ydir&#39;</span><span class="p">,</span> <span class="s">&#39;reverse&#39;</span> <span class="p">)</span>
<span class="n">box </span><span class="s">off</span><span class="p">;</span> <span class="n">set</span><span class="p">(</span><span class="n">gca</span><span class="p">,</span><span class="s">&#39;Visible&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">)</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="nb">sin</span><span class="p">(</span><span class="n">omega</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">);</span><span class="n"> hold </span><span class="s">on</span><span class="p"></span>
<span class="n">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s">&#39;s&#39;</span><span class="p">);</span>
<span class="n">set</span> <span class="p">(</span><span class="n">gca</span><span class="p">,</span> <span class="s">&#39;ydir&#39;</span><span class="p">,</span> <span class="s">&#39;reverse&#39;</span> <span class="p">)</span>
<span class="n">box </span><span class="s">off</span><span class="p">;</span> <span class="n">set</span><span class="p">(</span><span class="n">gca</span><span class="p">,</span><span class="s">&#39;Visible&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">2.7</span><span class="p">,</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="s">&#39;Second mode&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/bvps/eigenvalue_11_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can confirm that the system would actually behave in this way by setting up the system of ODEs and integrating based on initial conditions matching the amplitudes of the two modes.</p>
<p>For example, let's use $x_1 (t=0) = x_2(t=0) = 1$ for the first mode, and $x_1(t=0) = 1$ and $x_2(t=0) = -1$ for the second mode. We'll use zero initial velocity for both cases.</p>
<p>Then, we can solve by converting the system of two 2nd-order ODEs into a system of four 1st-order ODEs:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="c">%%file masses.m</span>
<span class="k">function</span><span class="w"> </span>dxdt <span class="p">=</span><span class="w"> </span><span class="nf">masses</span><span class="p">(</span>t, x<span class="p">)</span><span class="w"></span>
<span class="c">% this is a function file to calculate the derivatives associated with the system</span>

<span class="n">m1</span> <span class="p">=</span> <span class="mi">40</span><span class="p">;</span>
<span class="n">m2</span> <span class="p">=</span> <span class="mi">40</span><span class="p">;</span>
<span class="n">k</span> <span class="p">=</span> <span class="mi">200</span><span class="p">;</span>

<span class="n">dxdt</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>

<span class="n">dxdt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">dxdt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">m1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span>
<span class="n">dxdt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">=</span> <span class="n">x</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="n">dxdt</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">m2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Created file &#39;/Users/niemeyek/projects/ME373-book/content/bvps/masses.m&#39;.
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">clear </span><span class="s">all</span><span class="p">;</span><span class="n"> clc</span>

<span class="s">% this is the integration for the system in the first mode</span><span class="p"></span>
<span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">]</span> <span class="p">=</span> <span class="n">ode45</span><span class="p">(</span><span class="s">&#39;masses&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span> <span class="mf">0.0</span> <span class="mf">1.0</span> <span class="mf">0.0</span><span class="p">]);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span> <span class="n">t</span><span class="p">);</span> 
<span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;displacement (m)&#39;</span><span class="p">);</span> <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">set</span> <span class="p">(</span><span class="n">gca</span><span class="p">,</span> <span class="s">&#39;ydir&#39;</span><span class="p">,</span> <span class="s">&#39;reverse&#39;</span> <span class="p">)</span>
<span class="c">%box off; set(gca,&#39;Visible&#39;,&#39;off&#39;)</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">(:,</span><span class="mi">3</span><span class="p">),</span> <span class="n">t</span><span class="p">);</span> <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">set</span> <span class="p">(</span><span class="n">gca</span><span class="p">,</span> <span class="s">&#39;ydir&#39;</span><span class="p">,</span> <span class="s">&#39;reverse&#39;</span> <span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="s">&#39;First mode&#39;</span><span class="p">)</span>

<span class="c">% this is the integration for the system in the second mode</span>
<span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">]</span> <span class="p">=</span> <span class="n">ode45</span><span class="p">(</span><span class="s">&#39;masses&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span> <span class="mf">0.0</span> <span class="o">-</span><span class="mf">1.0</span> <span class="mf">0.0</span><span class="p">]);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span> <span class="n">t</span><span class="p">);</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;displacement (m)&#39;</span><span class="p">);</span> <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">set</span> <span class="p">(</span><span class="n">gca</span><span class="p">,</span> <span class="s">&#39;ydir&#39;</span><span class="p">,</span> <span class="s">&#39;reverse&#39;</span> <span class="p">)</span>
<span class="c">%box off; set(gca,&#39;Visible&#39;,&#39;off&#39;)</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">(:,</span><span class="mi">3</span><span class="p">),</span> <span class="n">t</span><span class="p">);</span> <span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;time (s)&#39;</span><span class="p">)</span>
<span class="n">set</span> <span class="p">(</span><span class="n">gca</span><span class="p">,</span> <span class="s">&#39;ydir&#39;</span><span class="p">,</span> <span class="s">&#39;reverse&#39;</span> <span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="s">&#39;Second mode&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/bvps/eigenvalue_14_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This shows that we get either of the pure modes of motion with the appropriate initial conditions.</p>
<p>What about if the initial conditions <em>don't</em> match either set of amplitude patterns?</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">X</span><span class="p">]</span> <span class="p">=</span> <span class="n">ode45</span><span class="p">(</span><span class="s">&#39;masses&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.25</span> <span class="mf">0.0</span> <span class="mf">0.75</span> <span class="mf">0.0</span><span class="p">]);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span> <span class="n">t</span><span class="p">);</span>
<span class="c">%plot(0,0, &#39;s&#39;);</span>
<span class="n">set</span> <span class="p">(</span><span class="n">gca</span><span class="p">,</span> <span class="s">&#39;ydir&#39;</span><span class="p">,</span> <span class="s">&#39;reverse&#39;</span> <span class="p">)</span>
<span class="c">%box off; set(gca,&#39;Visible&#39;,&#39;off&#39;)</span>

<span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">(:,</span><span class="mi">3</span><span class="p">),</span> <span class="n">t</span><span class="p">);</span>
<span class="n">set</span> <span class="p">(</span><span class="n">gca</span><span class="p">,</span> <span class="s">&#39;ydir&#39;</span><span class="p">,</span> <span class="s">&#39;reverse&#39;</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/bvps/eigenvalue_16_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this case, the resulting motion will be a complicated superposition of the two modes.</p>

</div>
</div>
</div>
</div>

 


    </main>
    