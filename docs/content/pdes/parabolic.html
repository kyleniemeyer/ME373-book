
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5.2. Parabolic PDEs &#8212; Mechanical Engineering Methods notes</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"vector": ["\\vec{#1}", 1], "uvec": ["\\hat{#1}", 1], "mag": ["\\lVert#1\\rVert", 1], "cross": "\\times", "unit": ["#1~\\mathrm{#2}", 2]}}, "tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Sample Quiz 2 problems: IVPs" href="../quizzes/quiz2-IVPs.html" />
    <link rel="prev" title="5.1. Elliptic PDEs" href="elliptic.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Mechanical Engineering Methods notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Ordinary Differential Equations
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../first-order.html">
   1. Solutions to 1st-order ODEs
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../numerical-methods/numerical-methods.html">
   2. Numerical Methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../numerical-methods/integrals.html">
     2.1. Numerical integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../numerical-methods/error.html">
     2.2. Error
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../numerical-methods/initial-value-methods.html">
     2.3. Numerical Solutions of 1st-order ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../numerical-methods/stability.html">
     2.4. Stability and Stiffness
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../second-order/second-order.html">
   3. Second-order Ordinary Differential Equations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../second-order/analytical.html">
     3.1. Analytical Solutions to 2nd-order ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../second-order/initial-value-problems.html">
     3.2. Initial-Value Problems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../second-order/numerical-methods.html">
     3.3. Numerical methods for 2nd-order ODEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../second-order/fourier-series.html">
     3.4. Fourier Series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../second-order/power-series.html">
     3.5. Power Series Solutions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../bvps/boundary-value-problems.html">
   4. Boundary Value Problems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvps/shooting-method.html">
     4.1. Shooting Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvps/finite-difference.html">
     4.2. Finite difference method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvps/eigenvalue.html">
     4.3. Eigenvalue problems
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Partial Differential Equations
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="partial-differential-equations.html">
   5. Partial Differential Equations
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="elliptic.html">
     5.1. Elliptic PDEs
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     5.2. Parabolic PDEs
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Sample Quizzes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../quizzes/quiz2-IVPs.html">
   Sample Quiz 2 problems: IVPs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../quizzes/quiz3-BVPs.html">
   Sample Quiz 3 problems: BVPs
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  About
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://github.com/kyleniemeyer/ME373-book">
   GitHub repository
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contributing.html">
   Contributing to Jupyter Book
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/content/pdes/parabolic.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/kyleniemeyer/ME373-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/kyleniemeyer/ME373-book/issues/new?title=Issue%20on%20page%20%2Fcontent/pdes/parabolic.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/kyleniemeyer/ME373-book/edit/master/content/pdes/parabolic.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/kyleniemeyer/ME373-book/master?urlpath=tree/content/pdes/parabolic.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#explicit-scheme">
   5.2.1. Explicit scheme
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implicit-scheme">
   5.2.2. Implicit scheme
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="parabolic-pdes">
<h1><span class="section-number">5.2. </span>Parabolic PDEs<a class="headerlink" href="#parabolic-pdes" title="Permalink to this headline">¶</a></h1>
<p>A classic example of a parabolic partial differential equation (PDE) is the one-dimensional unsteady heat equation:</p>
<div class="amsmath math notranslate nohighlight" id="equation-b1eedf4e-93a8-44ac-8b46-9f3d3cd0de0d">
<span class="eqno">(5.25)<a class="headerlink" href="#equation-b1eedf4e-93a8-44ac-8b46-9f3d3cd0de0d" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{\partial T}{\partial t} = \alpha \frac{\partial^2 T}{\partial t^2} 
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(T(x,t)\)</span> is the temperature varying in space and time, and <span class="math notranslate nohighlight">\(\alpha\)</span> is the thermal diffusivity: <span class="math notranslate nohighlight">\(\alpha = k / (\rho c_p)\)</span>, which is a constant.</p>
<p>We can solve this using finite differences to represent the spatial derivatives and time derivatives separately.
First, let’s rearrange the PDE slightly:</p>
<div class="amsmath math notranslate nohighlight" id="equation-e4355258-8f28-4add-86ea-bd9daa689053">
<span class="eqno">(5.26)<a class="headerlink" href="#equation-e4355258-8f28-4add-86ea-bd9daa689053" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{\partial^2 T}{\partial x^2} = \frac{1}{\alpha} \frac{\partial T}{\partial t}
\end{equation}\]</div>
<div class="section" id="explicit-scheme">
<h2><span class="section-number">5.2.1. </span>Explicit scheme<a class="headerlink" href="#explicit-scheme" title="Permalink to this headline">¶</a></h2>
<p>Let’s use a <em>central difference</em> for the spatial derivative with a spacing of <span class="math notranslate nohighlight">\(\Delta x\)</span>, and a <em>forward difference</em> for the time derivative with a time-step size of <span class="math notranslate nohighlight">\(\Delta t\)</span>. With these choices, we can obtain an approximation to the PDE that applies at time <span class="math notranslate nohighlight">\(t^k\)</span> and spatial location <span class="math notranslate nohighlight">\(x_i\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-33d99d58-8b2b-453e-9994-5576fc74a9d2">
<span class="eqno">(5.27)<a class="headerlink" href="#equation-33d99d58-8b2b-453e-9994-5576fc74a9d2" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{T_{i-1}^k - 2 T_i^k + T_{i+1}^k}{\Delta x^2} = \frac{1}{\alpha} \left( \frac{T_i^{k+1} - T_i^k}{\Delta t} \right)
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(T_i^k\)</span> is the temperature at time <span class="math notranslate nohighlight">\(t^k\)</span> and spatial location <span class="math notranslate nohighlight">\(x_i\)</span>. The following figure shows the stencil of points involved in the PDE, for a domain with five points in the <span class="math notranslate nohighlight">\(x\)</span>-direction.</p>
<div class="figure align-default" id="fig-stencil-explicit">
<a class="bg-primary mb-1 reference internal image-reference" href="../../_images/parabolic-explicit-stencil.png"><img alt="stencil for explicit parabolic solution" class="bg-primary mb-1" src="../../_images/parabolic-explicit-stencil.png" style="width: 350px;" /></a>
<p class="caption"><span class="caption-number">Fig. 5.7 </span><span class="caption-text">Stencil for explicit solution to heat equation</span><a class="headerlink" href="#fig-stencil-explicit" title="Permalink to this image">¶</a></p>
</div>
<p>To solve the heat equation for a one-dimensional domain over <span class="math notranslate nohighlight">\(0 \leq x \leq L\)</span>, we will need both initial conditions at <span class="math notranslate nohighlight">\(t = 0\)</span> and boundary conditions at <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x=L\)</span> (for all time). In terms of our nodal values, this means we need <span class="math notranslate nohighlight">\(T_i^{k=1}\)</span> for <span class="math notranslate nohighlight">\(i = 1 \ldots n\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is the number of points, as well as information about <span class="math notranslate nohighlight">\(T_1^k\)</span> and <span class="math notranslate nohighlight">\(T_n^k\)</span> for all times <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>We can rearrange the above equation to obtain our recursion formula:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d2d1dc56-05d8-4223-bb82-ad9950a42576">
<span class="eqno">(5.28)<a class="headerlink" href="#equation-d2d1dc56-05d8-4223-bb82-ad9950a42576" title="Permalink to this equation">¶</a></span>\[\begin{equation}
T_i^{k+1} = \left( T_{i+1}^k + T_{i-1}^k \right) \frac{\alpha \Delta t}{\Delta x^2} + T_i^k  \left( 1 - 2 \frac{\alpha \Delta t}{\Delta x^2} \right) \;.
\end{equation}\]</div>
<p>This is an <strong>explicit</strong> scheme in time, similar to the Forward Euler method we used for ordinary differential equations, and like that method it may have stability issues. The combination of terms we see repeated is also known as the Fourier number: <span class="math notranslate nohighlight">\(\text{Fo} = \frac{\alpha \Delta t}{\Delta x^2}\)</span>, and governs the stability.
We can rewrite the recursion formula using this:</p>
<div class="amsmath math notranslate nohighlight" id="equation-40d8ec26-7783-47c8-8a89-2829bf5a3b4f">
<span class="eqno">(5.29)<a class="headerlink" href="#equation-40d8ec26-7783-47c8-8a89-2829bf5a3b4f" title="Permalink to this equation">¶</a></span>\[\begin{equation}
T_i^{k+1} = \left( T_{i+1}^k + T_{i-1}^k \right) \text{Fo} + T_i^k  \left( 1 - 2 \text{Fo} \right) \;.
\end{equation}\]</div>
<p>The term in parentheses there must be greater than or equal to zero for stability (<span class="math notranslate nohighlight">\(1 - 2 \text{Fo} \geq 0\)</span>); if not, the solution may become unstable and blow up. This gives us some conditions on our choice of step sizes:</p>
<div class="amsmath math notranslate nohighlight" id="equation-74610277-581b-4ba4-9ff9-e7e6fc2be964">
<span class="eqno">(5.30)<a class="headerlink" href="#equation-74610277-581b-4ba4-9ff9-e7e6fc2be964" title="Permalink to this equation">¶</a></span>\[\begin{align}
1 - 2 \text{Fo} &amp;\geq 0 \\
1 &amp; \geq 2 \text{Fo} \\
\text{Fo} &amp;\leq \frac{1}{2} \\
\frac{\alpha \Delta t}{\Delta x^2} &amp;\leq \frac{1}{2}
\end{align}\]</div>
<p>This is the stability criterion for the explicit method: the Fourier number must be smaller than 0.5.
For a given thermal diffusivity and chosen spatial step size, this also gives us the limit on the time-step size: <span class="math notranslate nohighlight">\(\Delta t \leq \Delta x^2 / (2 \alpha)\)</span>.</p>
<p>Let’s look at an example where the initial temperature is 200, the temperature at the boundaries are 50, the thermal diffusivity is <span class="math notranslate nohighlight">\(\alpha = 2.3 \times 10^{-1}\)</span> m<span class="math notranslate nohighlight">\(^2 /\)</span> s, and <span class="math notranslate nohighlight">\(L = 1\)</span>.
In other words,</p>
<div class="amsmath math notranslate nohighlight" id="equation-7149925f-cde6-4c8f-9a07-2e5b6e814705">
<span class="eqno">(5.31)<a class="headerlink" href="#equation-7149925f-cde6-4c8f-9a07-2e5b6e814705" title="Permalink to this equation">¶</a></span>\[\begin{align}
T(x, t=0) &amp;= 200 \\
T(x=0, t) &amp;= 50 \\
T(x=L, t) &amp;= 50
\end{align}\]</div>
<p>We’ll integrate out to <span class="math notranslate nohighlight">\(t = 1\)</span>, using a Fourier number of 0.25 to be comfortably below the stability limit (<code class="docutils literal notranslate"><span class="pre">Fo</span> <span class="pre">=</span> <span class="pre">0.25</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">clear</span><span class="w"> </span><span class="nb">all</span><span class="w"></span>

<span class="n">dx</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"></span>
<span class="nb">alpha</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">2.3e-1</span><span class="p">;</span><span class="w"></span>

<span class="c">% for stability, set the Fourier number at 0.25 (half the stability limit of 0.5)</span><span class="w"></span>
<span class="n">Fo</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.25</span><span class="p">;</span><span class="w"></span>
<span class="c">% then choose the time step based on the Fourier number</span><span class="w"></span>
<span class="n">dt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Fo</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dx</span>^<span class="mi">2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">alpha</span><span class="p">;</span><span class="w"></span>

<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
<span class="n">t</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">);</span><span class="w"></span>

<span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span><span class="w"></span>

<span class="c">% initial conditions</span><span class="w"></span>
<span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">,:)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">200</span><span class="p">;</span><span class="w"></span>

<span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">,:))</span><span class="w"></span>
<span class="nb">axis</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="mi">200</span><span class="p">]);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Distance&#39;</span><span class="p">);</span><span class="w"> </span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Temperature&#39;</span><span class="p">);</span><span class="w"></span>
<span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">getframe</span><span class="p">(</span><span class="nb">gcf</span><span class="p">);</span><span class="w"></span>

<span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">n</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">elseif</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="w"></span>
<span class="w">            </span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span><span class="w"></span>
<span class="w">            </span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">Fo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">i</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">Fo</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span><span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,:))</span><span class="w"></span>
<span class="w">    </span><span class="nb">axis</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="mi">200</span><span class="p">]);</span><span class="w"></span>
<span class="w">    </span><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Distance&#39;</span><span class="p">);</span><span class="w"> </span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Temperature&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">getframe</span><span class="p">(</span><span class="nb">gcf</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
<span class="nb">close</span><span class="w"></span>

<span class="c">%% If you are working interactively, you can use this to make a movie in Matlab</span><span class="w"></span>
<span class="c">%fig = figure;</span><span class="w"></span>
<span class="c">%movie(fig, F, 2)</span><span class="w"></span>

<span class="c">%% This generates a GIF of the results (for use in Jupyter Notebook)</span><span class="w"></span>
<span class="n">filename</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;parabolic_animated.gif&#39;</span><span class="p">;</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">im</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">frame2im</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">imind</span><span class="p">,</span><span class="n">cm</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">rgb2ind</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="mi">256</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="c">% Write to GIF</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span>
<span class="w">        </span><span class="nb">imwrite</span><span class="p">(</span><span class="n">imind</span><span class="p">,</span><span class="n">cm</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Loopcount&#39;</span><span class="p">,</span><span class="n">inf</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DelayTime&#39;</span><span class="p">,</span><span class="mf">1e-3</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span>
<span class="w">        </span><span class="nb">imwrite</span><span class="p">(</span><span class="n">imind</span><span class="p">,</span><span class="n">cm</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="s">&#39;WriteMode&#39;</span><span class="p">,</span><span class="s">&#39;append&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DelayTime&#39;</span><span class="p">,</span><span class="mf">1e-3</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-transient-heat">
<a class="bg-primary mb-1 reference internal image-reference" href="../../_images/parabolic_animated.gif"><img alt="movie of parabolic PDE solution" class="bg-primary mb-1" src="../../_images/parabolic_animated.gif" style="width: 450px;" /></a>
<p class="caption"><span class="caption-number">Fig. 5.8 </span><span class="caption-text">Animated solution to 1D transient heat transfer PDE</span><a class="headerlink" href="#fig-transient-heat" title="Permalink to this image">¶</a></p>
</div>
<p>This shows the temperature decaying exponentially from the initial conditions, constrained by the boundary conditions.</p>
<p>What happens if we tried to use a Fourier number larger than 0.5, or arbitrarily chose a time-step size that was too large (and resulted in <span class="math notranslate nohighlight">\(\text{Fo} &gt; 0.5\)</span>)?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">clear</span><span class="w"> </span><span class="nb">all</span><span class="w"></span>

<span class="n">dx</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"></span>
<span class="nb">alpha</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">2.3e-1</span><span class="p">;</span><span class="w"></span>

<span class="c">%% Purposely choose a Fourier number that is past the stability limit:</span><span class="w"></span>
<span class="n">Fo</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.75</span><span class="p">;</span><span class="w"></span>
<span class="n">dt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Fo</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dx</span>^<span class="mi">2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">alpha</span><span class="p">;</span><span class="w"></span>

<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"></span>
<span class="n">t</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">);</span><span class="w"></span>

<span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span><span class="w"></span>

<span class="c">% initial conditions</span><span class="w"></span>
<span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">,:)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">200</span><span class="p">;</span><span class="w"></span>

<span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">,:))</span><span class="w"></span>
<span class="nb">axis</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="mi">200</span><span class="p">]);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Distance&#39;</span><span class="p">);</span><span class="w"> </span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Temperature&#39;</span><span class="p">);</span><span class="w"></span>
<span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">getframe</span><span class="p">(</span><span class="nb">gcf</span><span class="p">);</span><span class="w"></span>

<span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">n</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">elseif</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="w"></span>
<span class="w">            </span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span><span class="w"></span>
<span class="w">            </span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">Fo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">i</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">Fo</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span><span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,:))</span><span class="w"></span>
<span class="w">    </span><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Distance&#39;</span><span class="p">);</span><span class="w"> </span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Temperature&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">getframe</span><span class="p">(</span><span class="nb">gcf</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
<span class="nb">close</span><span class="w"></span>

<span class="c">%% If you are working interactively, you can use this to make a movie in Matlab</span><span class="w"></span>
<span class="c">%fig = figure;</span><span class="w"></span>
<span class="c">%movie(fig, F, 2)</span><span class="w"></span>

<span class="c">%% This generates a GIF of the results (for use in Jupyter Notebook)</span><span class="w"></span>
<span class="n">filename</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;parabolic_unstable_animated.gif&#39;</span><span class="p">;</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">im</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">frame2im</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">imind</span><span class="p">,</span><span class="n">cm</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">rgb2ind</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="mi">256</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="c">% Write to GIF</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span>
<span class="w">        </span><span class="nb">imwrite</span><span class="p">(</span><span class="n">imind</span><span class="p">,</span><span class="n">cm</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Loopcount&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DelayTime&#39;</span><span class="p">,</span><span class="mf">1e-3</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span>
<span class="w">        </span><span class="nb">imwrite</span><span class="p">(</span><span class="n">imind</span><span class="p">,</span><span class="n">cm</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="s">&#39;WriteMode&#39;</span><span class="p">,</span><span class="s">&#39;append&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DelayTime&#39;</span><span class="p">,</span><span class="mf">1e-3</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-unstable-solution">
<a class="bg-primary mb-1 reference internal image-reference" href="../../_images/parabolic_unstable_animated.gif"><img alt="movie of unstable parabolic PDE solution" class="bg-primary mb-1" src="../../_images/parabolic_unstable_animated.gif" style="width: 450px;" /></a>
<p class="caption"><span class="caption-number">Fig. 5.9 </span><span class="caption-text">Animated unstable solution</span><a class="headerlink" href="#fig-unstable-solution" title="Permalink to this image">¶</a></p>
</div>
<p>In this case, the solution becomes unstable and blows up, leading to unphysical results.</p>
<p>For this explicit scheme, the choice of <span class="math notranslate nohighlight">\(\Delta t\)</span> is limited by the stability criterion. This means that we may be stuck using a small time-step size.</p>
<p>Rather than being forced to use a very small time-step size, we can also explore <em>implicit schemes</em> that are unconditionally stable.</p>
</div>
<div class="section" id="implicit-scheme">
<h2><span class="section-number">5.2.2. </span>Implicit scheme<a class="headerlink" href="#implicit-scheme" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="nb">clear</span><span class="w"> </span><span class="nb">all</span><span class="w"></span>

<span class="nb">alpha</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">2.3e-1</span><span class="p">;</span><span class="w"></span>
<span class="n">dx</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"></span>
<span class="n">x</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">x</span><span class="p">);</span><span class="w"></span>

<span class="c">% choose a Fourier number that is deliberately past the explicit method stability limit</span><span class="w"></span>
<span class="n">Fo</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.75</span><span class="p">;</span><span class="w"></span>
<span class="n">dt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Fo</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dx</span>^<span class="mi">2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">alpha</span><span class="p">;</span><span class="w"></span>

<span class="n">t</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="mi">0</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">];</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">);</span><span class="w"></span>

<span class="n">T</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">);</span><span class="w"></span>

<span class="c">% Initial conditions</span><span class="w"></span>
<span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">,:)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">200</span><span class="p">;</span><span class="w"></span>

<span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="mi">1</span><span class="p">,:))</span><span class="w"></span>
<span class="nb">axis</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="mi">200</span><span class="p">]);</span><span class="w"></span>
<span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Distance&#39;</span><span class="p">);</span><span class="w"> </span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Temperature&#39;</span><span class="p">);</span><span class="w"></span>
<span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">getframe</span><span class="p">(</span><span class="nb">gcf</span><span class="p">);</span><span class="w"></span>

<span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="n">A</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">b</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">n</span><span class="w"></span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">            </span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">b</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">elseif</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">n</span><span class="w"></span>
<span class="w">            </span><span class="n">A</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">b</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">else</span><span class="w"></span>
<span class="w">            </span><span class="n">A</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="nb">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Fo</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">A</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">Fo</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">A</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">Fo</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="n">b</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="o">-</span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="nb">i</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="w">    </span>
<span class="w">    </span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">\</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="nb">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,:))</span><span class="w"></span>
<span class="w">    </span><span class="nb">axis</span><span class="p">([</span><span class="mi">0</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="mi">200</span><span class="p">]);</span><span class="w"></span>
<span class="w">    </span><span class="nb">xlabel</span><span class="p">(</span><span class="s">&#39;Distance&#39;</span><span class="p">);</span><span class="w"> </span><span class="nb">ylabel</span><span class="p">(</span><span class="s">&#39;Temperature&#39;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">F</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">getframe</span><span class="p">(</span><span class="nb">gcf</span><span class="p">);</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
<span class="nb">close</span><span class="w"></span>

<span class="c">%% This generates a GIF of the results (for use in Jupyter Notebook)</span><span class="w"></span>
<span class="n">filename</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;parabolic_implicit_animated.gif&#39;</span><span class="p">;</span><span class="w"></span>
<span class="k">for</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="nb">length</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">im</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">frame2im</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">imind</span><span class="p">,</span><span class="n">cm</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">rgb2ind</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="mi">256</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="c">% Write to GIF</span><span class="w"></span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nb">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span>
<span class="w">        </span><span class="nb">imwrite</span><span class="p">(</span><span class="n">imind</span><span class="p">,</span><span class="n">cm</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Loopcount&#39;</span><span class="p">,</span><span class="n">inf</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DelayTime&#39;</span><span class="p">,</span><span class="mf">1e-3</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span>
<span class="w">        </span><span class="nb">imwrite</span><span class="p">(</span><span class="n">imind</span><span class="p">,</span><span class="n">cm</span><span class="p">,</span><span class="n">filename</span><span class="p">,</span><span class="s">&#39;gif&#39;</span><span class="p">,</span><span class="s">&#39;WriteMode&#39;</span><span class="p">,</span><span class="s">&#39;append&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;DelayTime&#39;</span><span class="p">,</span><span class="mf">1e-3</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-implicit-solution">
<a class="bg-primary mb-1 reference internal image-reference" href="../../_images/parabolic_implicit_animated.gif"><img alt="movie of implicit parabolic PDE solution" class="bg-primary mb-1" src="../../_images/parabolic_implicit_animated.gif" style="width: 450px;" /></a>
<p class="caption"><span class="caption-number">Fig. 5.10 </span><span class="caption-text">Solution to 1D heat equation with implicit method. Fo = 0.75</span><a class="headerlink" href="#fig-implicit-solution" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "matlab"
        },
        kernelOptions: {
            kernelName: "matlab",
            path: "./content/pdes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'matlab'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="elliptic.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title"><span class="section-number">5.1. </span>Elliptic PDEs</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="../quizzes/quiz2-IVPs.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Sample Quiz 2 problems: IVPs</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Kyle Niemeyer<br/>
        
          <div class="extra_footer">
            <p xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" class="license-text"><a rel="cc:attributionURL" property="dct:title" href="https://github.com/kyleniemeyer/ME373-book">Mechanical Engineering Methods notes</a> by <span property="cc:attributionName">Kyle Niemeyer</span> is licensed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1" /><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1" /></a></p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>