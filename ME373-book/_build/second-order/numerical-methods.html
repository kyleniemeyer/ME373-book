---
interact_link: content/second-order/numerical-methods.ipynb
kernel_name: matlab
kernel_path: content/second-order
has_widgets: false
title: |-
  Numerical methods for 2nd-order ODEs
pagenum: 10
prev_page:
  url: /second-order/initial-value-problems.html
next_page:
  url: /contributing.html
suffix: .ipynb
search: y prime order z odes equation u t st begin frac f x end align solve ode nd dx using into system methods higher example lets method transforming given d w sin omega forward euler store numerical weve same transform dy where mass spring problem dz dt yi delta leq e heuns well need column gone any already discussed our meaning coupled du above thus instead talked far equations works too rd three rightarrow forced damped initial conditions start variables numerically recall recursion formula xi step size compare against exact solution obtainable undetermined coefficients cos schemes involve stage implement both

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Numerical methods for 2nd-order ODEs</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We've gone over how to solve 1st-order ODEs using numerical methods, but what about 2nd-order or any higher-order ODEs? We can use the same methods we've already discussed by transforming our higher-order ODEs into a <strong>system of first-order ODEs</strong>.</p>
<p>Meaning, if we are given a 2nd-order ODE
\begin{equation}
\frac{d^2 y}{dx^2} = y^{\prime\prime} = f(x, y, y^{\prime})
\end{equation}
we can transform this into a system of <strong>two 1st-order ODEs</strong> that are coupled:
\begin{align}
\frac{dy}{dx} &amp;= y^{\prime} = u \\
\frac{du}{dx} &amp;= u^{\prime} = y^{\prime\prime} = f(x, y, u)
\end{align}
where $f(x, y, u)$ is the same as that given above for $\frac{d^2 y}{dx^2}$.</p>
<p>Thus, instead of a 2nd-order ODE to solve, we have two 1st-order ODEs:
\begin{align}
y^{\prime} &amp;= u \\
u^{\prime} &amp;= f(x, y, u)
\end{align}</p>
<p>So, we can use all of the methods we have talked about so far to solve 2nd-order ODEs by transforming the one equation into a system of two 1st-order equations.</p>
<h2 id="Higher-order-ODEs">Higher-order ODEs<a class="anchor-link" href="#Higher-order-ODEs"> </a></h2><p>This works for higher-order ODEs too! For example, if we have a 3rd-order ODE, we can transform it into a system of three 1st-order ODEs:
\begin{align}
\frac{d^3 y}{dx^3} &amp;= f(x, y, y^{\prime}, y^{\prime\prime}) \\
\rightarrow y^{\prime} &amp;= u \\
u^{\prime} &amp;= y^{\prime\prime} = w \\
w^{\prime} &amp;= y^{\prime\prime\prime} = f(x, y, u, w)
\end{align}</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example:-mass-spring-problem">Example: mass-spring problem<a class="anchor-link" href="#Example:-mass-spring-problem"> </a></h2><p>For example, let's solve a forced damped mass-spring problem given by a 2nd-order ODE:
\begin{equation}
y^{\prime\prime} + 5y^{\prime} + 6y = 10 \sin \omega t
\end{equation}
with the initial conditions $y(0) = 0$ and $y^{\prime}(0) = 5$.</p>
<p>We start by transforming the equation into two 1st-order ODEs. Let's use the variables $z_1 = y$ and $z_2 = y^{\prime}$:
\begin{align}
\frac{dz_1}{dt} &amp;= z_1^{\prime} = z_2 \\
\frac{dz_2}{dt} &amp;= z_2^{\prime} = y^{\prime\prime} = 10 \sin \omega t - 5z_2 - 6z_1
\end{align}</p>
<h3 id="Forward-Euler">Forward Euler<a class="anchor-link" href="#Forward-Euler"> </a></h3><p>Then, let's solve numerically using the forward Euler method. Recall that the recursion formula for forward Euler is:
\begin{equation}
y_{i+1} = y_i + \Delta x f(x_i, y_i)
\end{equation}
where $f(x,y) = \frac{dy}{dx}$.</p>
<p>Let's solve using $\omega = 1$ and with a step size of $\Delta t = 0.1$, over $0 \leq t \leq 3$.</p>
<p>We can compare this against the exact solution, obtainable using the method of undetermined coefficients:
\begin{equation}
y(t) = -6 e^{-3t} + 7 e^{-2t} + \sin t - \cos t
\end{equation}</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="c">% plot exact solution first</span>
<span class="n">t</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="n">y_exact</span> <span class="p">=</span> <span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="nb">cos</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_exact</span><span class="p">);</span><span class="n"> hold </span><span class="s">on</span><span class="p"></span>

<span class="n">omega</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span> <span class="p">:</span> <span class="n">dt</span> <span class="p">:</span> <span class="mi">3</span><span class="p">];</span>

<span class="n">f</span> <span class="p">=</span> <span class="p">@(</span><span class="n">t</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span><span class="n">z2</span><span class="p">)</span> <span class="mi">10</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">z2</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">z1</span><span class="p">;</span>

<span class="n">z1</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">z2</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">z1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">z2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">5</span><span class="p">;</span><span class="n"></span>
<span class="n">for </span><span class="s">i = 1 : length(t)-1</span><span class="p"></span>
    <span class="n">z1</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">z1</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">z2</span><span class="p">(</span><span class="nb">i</span><span class="p">);</span>
    <span class="n">z2</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">z2</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span> <span class="n">z1</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span> <span class="n">z2</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span><span class="n"></span>
<span class="n">end</span>

<span class="s">plot(t, z1, &#39;o--&#39;)</span><span class="p"></span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">);</span> <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;displacement&#39;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">(</span><span class="s">&#39;Exact&#39;</span><span class="p">,</span> <span class="s">&#39;Forward Euler&#39;</span><span class="p">,</span> <span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="s">&#39;southeast&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/second-order/numerical-methods_2_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Heun's-Method">Heun's Method<a class="anchor-link" href="#Heun's-Method"> </a></h3><p>For schemes that involve more than one stage, like Heun's method, we'll need to implement both stages for each 1st-order ODE. For example:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="n">clear</span>
<span class="s">% plot exact solution first</span><span class="p"></span>
<span class="n">t</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="n">y_exact</span> <span class="p">=</span> <span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="nb">cos</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_exact</span><span class="p">);</span><span class="n"> hold </span><span class="s">on</span><span class="p"></span>

<span class="n">omega</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="n">dt</span> <span class="p">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span> <span class="p">:</span> <span class="n">dt</span> <span class="p">:</span> <span class="mi">3</span><span class="p">];</span>

<span class="n">f</span> <span class="p">=</span> <span class="p">@(</span><span class="n">t</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span><span class="n">z2</span><span class="p">)</span> <span class="mi">10</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">z2</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">z1</span><span class="p">;</span>

<span class="n">z1</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">z2</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">z1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">z2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">5</span><span class="p">;</span><span class="n"></span>
<span class="n">for </span><span class="s">i = 1 : length(t)-1</span><span class="p"></span>
    <span class="c">% predictor</span>
    <span class="n">z1p</span> <span class="p">=</span> <span class="n">z1</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">z2</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span><span class="p">;</span>
    <span class="n">z2p</span> <span class="p">=</span> <span class="n">z2</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span> <span class="n">z1</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span> <span class="n">z2</span><span class="p">(</span><span class="nb">i</span><span class="p">))</span><span class="o">*</span><span class="n">dt</span><span class="p">;</span>

    <span class="c">% corrector</span>
    <span class="n">z1</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">z1</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">z2</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">z2p</span><span class="p">);</span>
    <span class="n">z2</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">z2</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dt</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span> <span class="n">z1</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span> <span class="n">z2</span><span class="p">(</span><span class="nb">i</span><span class="p">))</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">z1p</span><span class="p">,</span> <span class="n">z2p</span><span class="p">));</span><span class="n"></span>
<span class="n">end</span>
<span class="s">plot(t, z1, &#39;o&#39;)</span><span class="p"></span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">);</span> <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;displacement&#39;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">(</span><span class="s">&#39;Exact&#39;</span><span class="p">,</span> <span class="s">&#39;Heuns&#39;</span><span class="p">,</span> <span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="s">&#39;southeast&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/second-order/numerical-methods_4_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Runge-Kutta:-ode45">Runge-Kutta: <code>ode45</code><a class="anchor-link" href="#Runge-Kutta:-ode45"> </a></h3><p>We can also solve using <code>ode45</code>, by providing a separate function file that defines the system of 1st-order ODEs. In this case, we'll need to use a single <strong>array</strong> variable, <code>Z</code>, to store $z_1$ and $z_2$. The first column of <code>Z</code> will store $z_1$ (<code>Z(:,1)</code>) and the second column will store $z_2$ (<code>Z(:,2)</code>).</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="c">%%file mass_spring.m</span>
<span class="k">function</span><span class="w"> </span>dzdt <span class="p">=</span><span class="w"> </span><span class="nf">mass_spring</span><span class="p">(</span>t, z<span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">omega</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">dzdt</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
    
    <span class="n">dzdt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="n">z</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">dzdt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">=</span> <span class="mi">10</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">z</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="n"></span>
<span class="n">end</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Created file &#39;/Users/kyle/projects/ME373/docs/mass_spring.m&#39;.
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-matlab"><pre><span></span><span class="c">% plot exact solution first</span>
<span class="n">t</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="n">y_exact</span> <span class="p">=</span> <span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="nb">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="nb">cos</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_exact</span><span class="p">);</span><span class="n"> hold </span><span class="s">on</span><span class="p"></span>

<span class="c">% solution via ode45:</span>
<span class="p">[</span><span class="n">T</span><span class="p">,</span> <span class="n">Z</span><span class="p">]</span> <span class="p">=</span> <span class="n">ode45</span><span class="p">(</span><span class="s">&#39;mass_spring&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">5</span><span class="p">]);</span>

<span class="n">plot</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">Z</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span> <span class="s">&#39;o&#39;</span><span class="p">)</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">);</span> <span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;displacement&#39;</span><span class="p">)</span>
<span class="n">legend</span><span class="p">(</span><span class="s">&#39;Exact&#39;</span><span class="p">,</span> <span class="s">&#39;ode45&#39;</span><span class="p">,</span> <span class="s">&#39;Location&#39;</span><span class="p">,</span><span class="s">&#39;southeast&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/second-order/numerical-methods_7_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

 


    </main>
    